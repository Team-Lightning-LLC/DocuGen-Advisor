<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DocuGen Dashboard</title>
<style>
  :root{
    --primary: #336F51;
    --primary-light: #4a8a6a;
    --primary-dark: #2a5a43;
    --ink: #1f2d3d;
    --muted: #6c7a89;
    --border: #e0e5ea;
    --hair: #eceff3;
    --bg: #f5f6f7;
    --card: #fff;
    --soft: #f8f9fb;
    --ok: #1f7a4d;
    --warn: #8a5a00;
    --info: #2d5699;
    --shadow: 0 6px 18px rgba(20,26,38,.08);
  }
  
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  
  html, body {
    height: 100%;
    overflow: hidden;
  }
  
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
    background: var(--bg);
    color: var(--ink);
    line-height: 1.5;
    display: flex;
    flex-direction: column;
  }

  /* Header */
  .header {
    background: var(--card);
    border-bottom: 1px solid var(--border);
    flex-shrink: 0;
  }
  
  .header-top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 24px;
  }
  
  .brand {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  
  .logo {
    width: 32px;
    height: 32px;
    background: var(--primary);
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: bold;
    font-size: 14px;
  }
  
  .brand-text h1 {
    font-size: 18px;
    font-weight: 600;
    color: var(--ink);
  }
  
  .brand-text p {
    font-size: 13px;
    color: var(--muted);
  }
  
  .page-indicator {
    color: var(--muted);
    font-size: 16px;
    font-weight: 500;
  }
  
  .nav-tabs {
    border-top: 1px solid var(--border);
    display: flex;
    padding: 0 24px;
    background: var(--card);
  }
  
  .nav-tab {
    padding: 12px 0;
    margin-right: 32px;
    color: var(--muted);
    text-decoration: none;
    font-weight: 500;
    border-bottom: 2px solid transparent;
    transition: all 0.2s;
    cursor: pointer;
  }
  
  .nav-tab.active {
    color: var(--ink);
    border-bottom-color: var(--primary);
  }
  
  .nav-tab:hover {
    color: var(--primary);
  }

  /* Dashboard Banner */
  .dashboard-banner {
    background: var(--primary);
    color: white;
    text-align: center;
    padding: 24px;
    font-size: 32px;
    font-weight: 600;
    flex-shrink: 0;
  }

  /* Main Content */
  .main-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 24px;
    width: 100%;
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }
  
  .page-title {
    font-size: 24px;
    font-weight: 600;
    color: var(--ink);
    margin-bottom: 24px;
  }

  /* KPI Cards */
  .kpi-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 20px;
    margin-bottom: 24px;
    flex-shrink: 0;
  }
  
  .kpi-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    box-shadow: var(--shadow);
  }
  
  .kpi-value {
    font-size: 36px;
    font-weight: 700;
    color: var(--ink);
    display: block;
    margin-bottom: 4px;
  }
  
  .kpi-label {
    font-size: 14px;
    color: var(--ink);
    font-weight: 600;
  }
  
  .kpi-sublabel {
    font-size: 12px;
    color: var(--muted);
    margin-top: 2px;
  }

  /* Content Grid */
  .content-grid {
    display: grid;
    grid-template-columns: 1fr 1fr 300px;
    gap: 20px;
    flex: 1;
    overflow: hidden;
  }
  
  .content-section {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    box-shadow: var(--shadow);
  }
  
  .section-header {
    padding: 16px 20px;
    border-bottom: 1px solid var(--hair);
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-shrink: 0;
    background: var(--card);
  }
  
  .section-title {
    font-size: 16px;
    font-weight: 600;
    color: var(--ink);
  }
  
  .sort-btn {
    background: none;
    border: 1px solid var(--border);
    border-radius: 6px;
    padding: 4px 8px;
    font-size: 12px;
    color: var(--muted);
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .sort-btn:hover {
    border-color: var(--primary);
    color: var(--primary);
  }

  /* Scrollable Content Areas */
  .scrollable-content {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
  }

  /* Tables */
  .table-container {
    flex: 1;
    overflow-y: auto;
  }
  
  table {
    width: 100%;
    border-collapse: collapse;
  }
  
  th, td {
    padding: 12px 20px;
    text-align: left;
    border-bottom: 1px solid var(--hair);
  }
  
  th {
    background: var(--soft);
    font-size: 12px;
    font-weight: 600;
    color: var(--muted);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    position: sticky;
    top: 0;
  }
  
  td {
    font-size: 14px;
    color: var(--ink);
  }
  
  .queue-item-cell {
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .spinner {
    width: 16px;
    height: 16px;
    border: 2px solid var(--border);
    border-left-color: var(--primary);
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  
  @keyframes spin {
    to { transform: rotate(360deg); }
  }

  /* Document List */
  .document-item {
    padding: 16px 20px;
    border-bottom: 1px solid var(--hair);
    transition: background 0.2s;
    display: flex;
    flex-direction: column;
    gap: 4px;
  }
  
  .document-item:hover {
    background: var(--soft);
  }
  
  .document-item:last-child {
    border-bottom: none;
  }
  
  .document-name {
    font-size: 14px;
    font-weight: 600;
    color: var(--ink);
  }
  
  .document-meta {
    font-size: 12px;
    color: var(--muted);
    display: flex;
    gap: 8px;
  }
  
  .document-actions {
    display: flex;
    gap: 12px;
    margin-top: 8px;
  }
  
  .action-link {
    color: var(--primary);
    font-size: 12px;
    text-decoration: none;
    cursor: pointer;
    transition: color 0.2s;
  }
  
  .action-link:hover {
    color: var(--primary-dark);
    text-decoration: underline;
  }

  /* Client List */
  .client-item {
    padding: 16px 20px;
    border-bottom: 1px solid var(--hair);
    transition: background 0.2s;
    cursor: pointer;
  }
  
  .client-item:hover {
    background: var(--soft);
  }
  
  .client-item:last-child {
    border-bottom: none;
  }
  
  .client-name {
    font-size: 14px;
    font-weight: 600;
    color: var(--ink);
    margin-bottom: 4px;
  }
  
  .client-status {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
  }
  
  .status-indicator {
    width: 8px;
    height: 8px;
    border-radius: 50%;
  }
  
  .status-complete { 
    background: var(--ok); 
    color: var(--ok); 
  }
  
  .status-required { 
    background: var(--warn); 
    color: var(--warn); 
  }
  
  .client-docs {
    font-size: 11px;
    color: var(--muted);
    margin-top: 2px;
  }

  .empty-state {
    padding: 40px 20px;
    text-align: center;
    color: var(--muted);
    font-style: italic;
  }
</style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-top">
      <div class="brand">
        <div class="logo">DG</div>
        <div class="brand-text">
          <h1>DocuGen</h1>
          <p>By Doculabs</p>
        </div>
      </div>
      <div class="page-indicator">Dashboard</div>
    </div>
    <nav class="nav-tabs">
      <div class="nav-tab active">Dashboard</div>
      <div class="nav-tab" onclick="window.location.href='advisor.html'">Advisor</div>
      <div class="nav-tab">Research</div>
      <div class="nav-tab">Chat</div>
    </nav>
  </header>

  <!-- Dashboard Banner -->
  <div class="dashboard-banner">Dashboard</div>

  <!-- Main Content -->
  <div class="main-content">
    <div class="container">
      <h1 class="page-title">Overview</h1>
      
      <!-- KPI Cards -->
      <div class="kpi-grid">
        <div class="kpi-card">
          <span class="kpi-value" id="totalClients">4</span>
          <div class="kpi-label">Total Clients</div>
          <div class="kpi-sublabel">Active households</div>
        </div>
        
        <div class="kpi-card">
          <span class="kpi-value" id="activeUsers">1</span>
          <div class="kpi-label">Active Users</div>
          <div class="kpi-sublabel">Currently online</div>
        </div>
        
        <div class="kpi-card">
          <span class="kpi-value" id="totalDocs">29</span>
          <div class="kpi-label">Documents in Database</div>
          <div class="kpi-sublabel">Unique documents</div>
        </div>
        
        <div class="kpi-card">
          <span class="kpi-value" id="recentDocs">14</span>
          <div class="kpi-label">Docs (7d)</div>
          <div class="kpi-sublabel">New/generated</div>
        </div>
      </div>

      <!-- Content Sections -->
      <div class="content-grid">
        <!-- In Queue Documents -->
        <div class="content-section">
          <div class="section-header">
            <h2 class="section-title">In Queue Documents</h2>
          </div>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Document Name</th>
                  <th>Client Name</th>
                  <th>Start Time</th>
                  <th>Progress</th>
                </tr>
              </thead>
              <tbody id="queueTable">
                <tr>
                  <td colspan="4" class="empty-state">No documents currently generating</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Recent Documents -->
        <div class="content-section">
          <div class="section-header">
            <h2 class="section-title">Recent Documents</h2>
            <button class="sort-btn">Sort</button>
          </div>
          <div class="scrollable-content" id="documentsList">
            <div class="document-item">
              <div class="document-name">Ahmed_Ishmal_document_9.docx</div>
              <div class="document-meta">
                <span>Ahmed Ishmal</span>
                <span>•</span>
                <span>9/16/2025</span>
              </div>
              <div class="document-actions">
                <a class="action-link">View</a>
                <a class="action-link">Download</a>
              </div>
            </div>
            
            <div class="document-item">
              <div class="document-name">Chris_Lehman_Portfolio_Analysis_2025.md</div>
              <div class="document-meta">
                <span>Unknown Client</span>
                <span>•</span>
                <span>9/16/2025</span>
              </div>
              <div class="document-actions">
                <a class="action-link">View</a>
                <a class="action-link">Download</a>
              </div>
            </div>
            
            <div class="document-item">
              <div class="document-name">Ahmed_Ishmal_Retirement_Planning_Document.md</div>
              <div class="document-meta">
                <span>Unknown Client</span>
                <span>•</span>
                <span>9/16/2025</span>
              </div>
              <div class="document-actions">
                <a class="action-link">View</a>
                <a class="action-link">Download</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Clients -->
        <div class="content-section">
          <div class="section-header">
            <h2 class="section-title">Clients</h2>
            <button class="sort-btn">Sort</button>
          </div>
          <div class="scrollable-content" id="clientsList">
            <div class="client-item">
              <div class="client-name">Ahmed Ishmal</div>
              <div class="client-status">
                <div class="status-indicator status-complete"></div>
                <span class="status-complete">AI Profile Complete</span>
              </div>
              <div class="client-docs">4 documents</div>
            </div>
            
            <div class="client-item">
              <div class="client-name">Chris Lehman</div>
              <div class="client-status">
                <div class="status-indicator status-required"></div>
                <span class="status-required">AI Profile Required</span>
              </div>
              <div class="client-docs">6 documents</div>
            </div>
            
            <div class="client-item">
              <div class="client-name">Nigel Financial</div>
              <div class="client-status">
                <div class="status-indicator status-complete"></div>
                <span class="status-complete">AI Profile Complete</span>
              </div>
              <div class="client-docs">6 documents</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
// Same dynamic functionality as before, but with updated styling
const VERTESIA_API_KEY = 'sk-544583102491bf69b0351418bbdd2aa9';
const VERTESIA_BASE_URL = 'https://api.vertesia.io/api/v1';

let clientsData = {};
let documentsData = [];
let allDocuments = [];

// Queue management
class DashboardQueue {
  constructor() {
    this.activeGenerations = new Map();
    this.timers = new Map();
  }
  
  updateQueueDisplay() {
    const tbody = document.getElementById('queueTable');
    
    if (this.activeGenerations.size === 0) {
      tbody.innerHTML = '<tr><td colspan="4" class="empty-state">No documents currently generating</td></tr>';
      return;
    }
    
    // Update queue display logic here
  }
}

const dashboardQueue = new DashboardQueue();

async function loadClientsFromVertesia() {
  try {
    const response = await fetch(`${VERTESIA_BASE_URL}/objects?limit=1000&offset=0`, {
      method: 'GET',
      headers: {
        'Authorization': `Bearer ${VERTESIA_API_KEY}`,
        'Content-Type': 'application/json'
      }
    });

    if (response.ok) {
      const documents = await response.json();
      allDocuments = documents;
      updateDashboard();
    }
  } catch (error) {
    console.error('Failed to load data:', error);
  }
}

function updateDashboard() {
  // Update KPIs and content sections
  document.getElementById('totalClients').textContent = Object.keys(clientsData).length || 4;
  document.getElementById('totalDocs').textContent = allDocuments.length || 29;
  
  const sevenDaysAgo = new Date();
  sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
  const recentCount = allDocuments.filter(doc => {
    const docDate = new Date(doc.created_at || doc.updated_at);
    return docDate >= sevenDaysAgo;
  }).length;
  
  document.getElementById('recentDocs').textContent = recentCount || 14;
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  loadClientsFromVertesia();
});

// Auto-refresh every 30 seconds
setInterval(loadClientsFromVertesia, 30000);
</script>
</body>
</html>
